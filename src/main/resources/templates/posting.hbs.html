{{> part/top}}

{{#if posting.timelineMoment}}
    <a class="btn btn-outline-secondary btn-sm"
       href="/timeline?before={{posting.timelineMoment}}#m{{posting.timelineMoment}}">&larr; Timeline</a>
{{/if}}

<div class="posting entry">
    {{#if posting.timelinePinned}}
        <div class="pin-line">
            <span class="badge badge-secondary">
                <i class="fas fa-thumbtack"></i>&nbsp;
                Pinned post
            </span>
        </div>
    {{/if}}
    <div class="owner">
        {{nodename posting.ownerName}}
        {{#if posting.receiverName}}
            {{#ifne posting.receiverName posting.ownerName}}
                &#x25b8; {{nodename posting.receiverName}}
            {{/ifne}}
        {{/if}}
        <span class="date">
            {{cal "dd-MM-yyyy HH:mm" es=posting.timelinePublishedAt fromNow="posting.time.relative"}}
            {{#ifgt posting.totalRevisions 1}}
                (updated {{cal "dd-MM-yyyy HH:mm" es=posting.editedAt fromNow="posting.time.relative"}})
            {{/ifgt}}
        </span>
    </div>
    {{#if posting.body.subject}}
        <div class="subject">{{posting.body.subject}}</div>
    {{/if}}
    <div class="content">{{{posting.body.text}}}</div>
    <div class="reactions-line">
        {{reactions posting}}
        {{#if posting.totalComments}}
            <div class="posting-comments">
                <a class="total-comments" href="/post/{{posting.id}}#comments">
                    <i class="fas fa-comment"></i>&nbsp;
                    {{posting.totalComments}}
                    {{#ifieq posting.totalComments 1}}comment{{else}}comments{{/ifieq}}
                </a>
            </div>
        {{/if}}
    </div>

    <a name="comments"></a>
    <div id="comments">
        {{#each comments}}
            <a name="m{{moment}}"></a>
            <div class="comment entry">
                <div class="owner-line">
                    <span class="owner">{{nodename ownerName}}</span>
                    <span class="date">
                        {{cal "dd-MM-yyyy HH:mm" es=createdAt fromNow="true"}}
                        {{#ifgt totalRevisions 1}}
                            (updated {{cal "dd-MM-yyyy HH:mm" es=editedAt fromNow="true"}})
                        {{/ifgt}}
                    </span>
                </div>
                <div class="content">{{{body.text}}}</div>
                <div class="reactions-line">
                    {{reactions this}}
                </div>
            </div>
        {{/each}}
    </div>
</div>

{{#if pagination}}
    <nav aria-label="Page navigation">
        <ul class="pagination justify-content-center">
            {{#each pagination}}
                {{#if dots}}
                    <li class="page-item"><span class="page-link page-dots">â‹¯</span></li>
                {{else}}
                    {{#if active}}
                        <li class="page-item active"><span class="page-link">{{title}}</span></li>
                    {{else}}
                        <li class="page-item">
                            {{#if first}}
                                <a class="page-link" href="/post/{{posting.id}}#comments">{{title}}</a>
                            {{else}}
                                <a class="page-link" href="/post/{{posting.id}}?before={{moment}}#comments">{{title}}</a>
                            {{/if}}
                        </li>
                    {{/if}}
                {{/if}}
            {{/each}}
        </ul>
    </nav>
{{/if}}

{{> part/bottom}}
